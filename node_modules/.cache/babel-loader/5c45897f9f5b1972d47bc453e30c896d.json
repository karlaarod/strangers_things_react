{"ast":null,"code":"import _slicedToArray from\"/Users/karlarodriguez/Desktop/course_work/strangers_thing_react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/Users/karlarodriguez/Desktop/course_work/strangers_thing_react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/karlarodriguez/Desktop/course_work/strangers_thing_react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useState,useEffect}from\"react\";import{Route,useHistory}from\"react-router-dom\";import{Account,List,Post,Nav,NewPost,Profile,Message,Inbox,ViewUserPosts}from\"./\";import{callApi}from\"../api\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var fetchUserData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(token){var _yield$callApi,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return callApi({url:\"/users/me\",token:token});case 2:_yield$callApi=_context.sent;data=_yield$callApi.data;return _context.abrupt(\"return\",data);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchUserData(_x){return _ref.apply(this,arguments);};}();var fetchPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$callApi2,posts;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return callApi({url:\"/posts\"});case 2:_yield$callApi2=_context2.sent;posts=_yield$callApi2.data.posts;return _context2.abrupt(\"return\",posts);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchPosts(){return _ref2.apply(this,arguments);};}();var App=function App(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),userData=_useState4[0],setUserData=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),posts=_useState6[0],setPosts=_useState6[1];var history=useHistory();console.log(\"token\",token);useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _posts,data,posts;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(token){_context3.next=7;break;}setToken(localStorage.getItem(\"token\"));_context3.next=4;return fetchPosts();case 4:_posts=_context3.sent;setPosts(_posts);return _context3.abrupt(\"return\");case 7:_context3.next=9;return fetchUserData(token);case 9:data=_context3.sent;if(data&&data.username){setUserData(data);}_context3.next=13;return fetchPosts();case 13:posts=_context3.sent;setPosts(posts);setUserData(data);case 16:case\"end\":return _context3.stop();}}},_callee3);})),[token]);console.log(\"userData\",userData);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Nav,{userData:userData,setUserData:setUserData,setToken:setToken}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",children:userData.username?/*#__PURE__*/_jsxs(\"div\",{className:\"title-page\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Hello, \",userData.username,\"!\"]}),/*#__PURE__*/_jsx(\"h1\",{children:\"Where Stranger is Better!\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"title-page\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Where Stranger is Better!\"})})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",children:/*#__PURE__*/_jsx(Account,{action:\"login\",setToken:setToken,setUserData:setUserData})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",children:/*#__PURE__*/_jsx(Account,{action:\"register\",setToken:setToken,setUserData:setUserData})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/posts\",children:/*#__PURE__*/_jsx(List,{posts:posts})}),/*#__PURE__*/_jsx(Route,{path:\"/posts/:postId\",children:/*#__PURE__*/_jsx(Post,{posts:posts,setPosts:setPosts,token:token,userData:userData})}),/*#__PURE__*/_jsx(Route,{path:\"/posts/:postId/messages\",children:/*#__PURE__*/_jsx(Message,{token:token})}),/*#__PURE__*/_jsxs(Route,{path:\"/dashboard\",children:[/*#__PURE__*/_jsx(Profile,{userData:userData,posts:posts,token:token}),console.log(\"profile\",userData)]}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard/messages\",children:/*#__PURE__*/_jsx(Inbox,{userData:userData,posts:posts})}),/*#__PURE__*/_jsx(Route,{path:\"/newPost\",children:/*#__PURE__*/_jsx(NewPost,{posts:posts,setPosts:setPosts,token:token})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/dashboard/myposts\",children:/*#__PURE__*/_jsx(ViewUserPosts,{userData:userData})})]});};export default App;","map":{"version":3,"sources":["/Users/karlarodriguez/Desktop/course_work/strangers_thing_react/src/components/App.js"],"names":["React","useState","useEffect","Route","useHistory","Account","List","Post","Nav","NewPost","Profile","Message","Inbox","ViewUserPosts","callApi","fetchUserData","token","url","data","fetchPosts","posts","App","setToken","userData","setUserData","setPosts","history","console","log","localStorage","getItem","username"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Route, useHistory } from \"react-router-dom\";\nimport {\n  Account,\n  List,\n  Post,\n  Nav,\n  NewPost,\n  Profile,\n  Message,\n  Inbox,\n  ViewUserPosts,\n} from \"./\";\nimport { callApi } from \"../api\";\n\nconst fetchUserData = async (token) => {\n  const { data } = await callApi({\n    url: \"/users/me\",\n    token,\n  });\n  return data;\n};\n\nconst fetchPosts = async () => {\n  const {\n    data: { posts },\n  } = await callApi({\n    url: \"/posts\",\n  });\n  return posts;\n};\n\nconst App = () => {\n  const [token, setToken] = useState(\"\");\n  const [userData, setUserData] = useState({});\n  const [posts, setPosts] = useState([]);\n  const history = useHistory();\n\n  console.log(\"token\", token);\n\n  useEffect(async () => {\n    if (!token) {\n      setToken(localStorage.getItem(\"token\"));\n      const posts = await fetchPosts();\n      setPosts(posts);\n      return;\n    }\n    const data = await fetchUserData(token);\n    if (data && data.username) {\n      setUserData(data);\n    }\n    const posts = await fetchPosts();\n    setPosts(posts);\n    setUserData(data);\n  }, [token]);\n\n  console.log(\"userData\", userData);\n\n  return (\n    <>\n      <Nav userData={userData} setUserData={setUserData} setToken={setToken} />\n\n      <Route exact path=\"/\">\n        {userData.username ? (\n          <div className=\"title-page\">\n            <h1>Hello, {userData.username}!</h1>\n            <h1>Where Stranger is Better!</h1>\n          </div>\n        ) : (\n          <div className=\"title-page\">\n            <h1>Where Stranger is Better!</h1>\n          </div>\n        )}\n      </Route>\n      <Route path=\"/login\">\n        <Account action=\"login\" setToken={setToken} setUserData={setUserData} />\n      </Route>\n      <Route path=\"/register\">\n        <Account\n          action=\"register\"\n          setToken={setToken}\n          setUserData={setUserData}\n        />\n      </Route>\n      <Route exact path=\"/posts\">\n        <List posts={posts} />\n      </Route>\n      <Route path=\"/posts/:postId\">\n        <Post\n          posts={posts}\n          setPosts={setPosts}\n          token={token}\n          userData={userData}\n        />\n      </Route>\n      <Route path=\"/posts/:postId/messages\">\n        <Message token={token}></Message>\n      </Route>\n      <Route path=\"/dashboard\">\n        <Profile userData={userData} posts={posts} token={token} />\n        {console.log(\"profile\", userData)}\n      </Route>\n      <Route path=\"/dashboard/messages\">\n        <Inbox userData={userData} posts={posts} />\n      </Route>\n      <Route path=\"/newPost\">\n        <NewPost posts={posts} setPosts={setPosts} token={token} />\n      </Route>\n      <Route exact path=\"/dashboard/myposts\">\n        <ViewUserPosts userData={userData} />\n      </Route>\n    </>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}